<!-- <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCeqTen9KlvtvGNuSj3Kz06RK7Gj4WZsAU"></script> -->
<section id="main" class="wrapper">
  <div class="container">
    
    <div id="EventsSearcher" class="EventsSearcher">
      <h2>Events {{type}}</h2>
      <label>Search events: </label>
      <input type="text" class="filtre" ng-model="$ctrl.filtro" style="vertical-align: middle;" ng-change="getMarkers()"
      ng-model-options='{ debounce: 200 }'>&nbsp;
      <button ng-click="ShowHideMap()" id="btnShowMap" class="btn btn-danger" name="btnShowMap"
      style="vertical-align: middle;">Ocultar Mapa</button>
    </div>
    
    <hr>
    
    <div class="eventsList" id="eventsListDiv">
      <!-- LOADDER -->
      <div ng-show="!$ctrl.eventsLoaded" id="preloader_1">
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
      </div>
      <div ng-show="!$ctrl.eventsLoaded"> <br> <br> Loading events...</div>
      <div ng-click="openDetails()"  ng-class='{EventListItem : event.stock != 0, EventListItemExhausted: event.stock == 0}' 
      class="EventListItem" id="eventItem" ng-repeat="event in $ctrl.Events | filter: $ctrl.filtro"
      id="{{event._id}}" ng-mouseover="showDetailsOnHover()" ng-mouseleave="hideDetailsOnMap()"> <!-- Sin paginacion-->
          <div max-width: "100%" >
            <img src="{{event.img}}" height="220" width="320"/>
          </div>
          <div style="padding: 2px 5px;">
          <div class="name" style="margin-top:5px;"><h3>{{event.name}}</h3></div>
          <div class="type"><i>{{event.type}}</i></div>
          <div class="place">{{event.place}}</div>
          <div class="price">{{event.price}}€</div>
          <div data-ng-if="event.stock != 0" class="stock"><strong> ¡Solo quedan {{event.stock}} entradas! </strong></div>
          <div data-ng-if="event.stock == 0" class="stocke"><strong> Entradas agotadas </strong> </div>
          <br>
          <br>
        </div>
      </div>
    </div>
    
    <div>
      <div map-lazy-load="https://maps.google.com/maps/api/js">
        <ng-map ng-show="$ctrl.showMap" center="[{{$ctrl.lat}}, {{$ctrl.lng}}]" zoom="6" default-style="false"
        class="mapEvents">
          <marker
          no-watcher="true"
          ng-repeat="p in $ctrl.positions"
          id="{{p.id}}"
          title="{{p.name}}"
          position="{{p.pos}}"
          on-click="showDetailsOnMap(p)"
          animation="DROP">
          </marker>
          <info-window id="myInfoWindow">
            <div class="infoWindowDiv" ng-non-bindable="true" ng-click="openDetails()">
              <h4 align="center">{{$ctrl.eventItem.name}}</h4>
              <br>
              <h4 align="center">{{$ctrl.eventItem.type}}</h4>
              <br>
              <img src="{{$ctrl.eventItem.imagen}}" width="250px" heigth="350px" align="center"></img>
              <br>
            </div>
          </info-window>
        </ng-map>
      </div>
    </div>
  </div>
  
  <div id="pager">
    <ul uib-pagination class="pagination-sm" boundary-link-numbers="true"
     total-items="$ctrl.Events.length" ng-model="$ctrl.currentPage"
      items-per-page="$ctrl.itemsPerPage" ng-change="$ctrl.pageChanged()">
    </ul>
  </div>
</section>
